@addTagHelper *, mostlylucid.pagingtaghelper
@using mostlylucid.pagingtaghelper.Extensions
@model mostlylucid.pagingtaghelper.Models.TagModels.PagerViewModel
@{
    var totalPages = Model.TotalPages;

    string GetUrl(int page) => Context.BuildPagedUrl(Model.LinkUrl ?? "", page, Model.PageSize, Model.SearchTerm, Model.OrderBy, Model.Descending);


}

    <div class="pager-container">
        @if (Model.ShowPageSize)
        {
            <page-size page-size-model="Model"></page-size>
        }

        @if (totalPages > 1)
        {
            @if (Model.FirstLastNavigation && Model.Page > 1)
            {
                var href = GetUrl(1);
                <a class="btn btn-sm btn-outline-primary"
                   href="@href">
                    @Model.FirstPageText
                </a>
            }

            @if (Model.Page > 1)
            {
                var href = GetUrl(Model.Page - 1);
                <a class="btn btn-sm btn-outline-primary"
                   href="@href">
                    @Model.PreviousPageText
                </a>
            }

            @if (Model.SkipForwardBackNavigation && Model.Page > Model.PagesToDisplay)
            {
                <span class="btn btn-sm btn-outline-secondary disabled">
                    @Model.SkipBackText
                </span>
            }

            @* Pagination Numbers *@
            @{
                int halfDisplay = Model.PagesToDisplay / 2;
                int startPage = Math.Max(1, Model.Page - halfDisplay);
                int endPage = Math.Min(totalPages, startPage + Model.PagesToDisplay - 1);
                startPage = Math.Max(1, endPage - Model.PagesToDisplay + 1);
            }
            @for (int i = startPage; i <= endPage; i++)
            {
                var href = GetUrl(i);
                <a data-page="@i"
                   class="btn btn-sm @(i == Model.Page ? "btn-primary" : "btn-outline-primary")"
                   href="@href">
                    @i
                </a>
            }

            @if (Model.SkipForwardBackNavigation && Model.Page < totalPages - Model.PagesToDisplay + 1)
            {
                <span class="btn btn-sm btn-outline-secondary disabled">
                    @Model.SkipForwardText
                </span>
            }

            @if (Model.Page < totalPages)
            {
                var href = GetUrl(Model.Page + 1);
                <a class="btn btn-sm btn-outline-primary"
                   href="@href"
                   aria-label="@Model.NextPageAriaLabel">
                    @Model.NextPageText
                </a>
            }

            @if (Model.FirstLastNavigation && Model.Page < totalPages)
            {
                var href = GetUrl(Model.TotalPages);
                <a class="btn btn-sm btn-outline-primary"
                   href="@href">
                    @Model.LastPageText
                </a>
            }

            @if (Model.ShowSummary)
            {
                <span class="badge bg-secondary">
                    @Model.GetPageSummary()
                </span>
            }
        }
    </div>